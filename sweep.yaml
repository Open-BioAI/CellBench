project: perturbench
name: sciplex3_hydra_bayes
method: bayes

metric:
  goal: maximize
  name: val_PCC_epoch

parameters:
  # 固定项
  data:
    value: mix_pert
  data.task:
    value: srivatsantrapnell2020_sciplex3
  data.data_path:
    value: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/data/all_cell_line_filterdrug.h5ad

  train:
    value: true
  test:
    value: true
  test_ckpt_type:
    value: pcc

  trainer.log_every_n_steps:
    value: 10
  trainer.max_epochs:
    value: 10
  trainer.min_epochs:
    value: 0
  trainer.devices:
    value: 1

  data.val_batch_size:
    value: 256
  data.test_batch_size:
    value: 256
  data.transform.use_covs:
    value: false

  model.use_mask:
    value: true
  model.use_cell_emb:
    value: false

  data.train_batch_size:
    value: 256
  
  # sweep 项（注意：model 只能是单值 categorical，不要让它变成 list）
  model:
    values: [biolord, cpa]

  # model.dropout:
  #   distribution: uniform
  #   min: 0.0
  #   max: 0.3

  model.lr:
    values: [1e-6, 1e-5, 1e-4, 1e-3]
    # distribution: log_uniform_values
    # min: 1e-6
    # max: 1e-3


  # model.lr_scheduler_max_lr:
  #   distribution: log_uniform_values
  #   min: 1e-4
  #   max: 1e-2

  # model.wd:
  #   distribution: log_uniform_values
  #   min: 1e-10
  #   max: 1e-6

# 核心：command 里只写 program，所有超参由 wandb 通过 ${args} 注入 (--key value)

program: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/src/perturbench/modelcore/train.py
command:
  - /fs-computility-new/upzd_share/maoxinjie/miniconda3/envs/qianhong_env/bin/python
  - ${program}
  - ${args}
