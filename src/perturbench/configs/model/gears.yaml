_target_: perturbench.modelcore.models.GEARS
data_path: ${paths.work_dir}
gene2go_path: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/data/gene2go.pkl
gene_set_path: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/data/essential_all_data_pert_genes.pkl
# pert_key: ${data.pert_key}
pert_key: "_merged_pert_col_"
comb_delim: ${data.perturbation_combination_delimiter}
control_val: ${data.control_val}
build_GO_workers: 100
seed: 42
hidden_size: 384
num_go_gnn_layers: 1
num_gene_gnn_layers: 2
decoder_hidden_size: 48
num_similar_genes_go_graph: 25
num_similar_genes_co_express_graph: 15
coexpress_threshold: 0.31
uncertainty: False
uncertainty_reg: 1
direction_lambda: 1e-1

use_cell_emb: false
use_mask: true  # Enable expression mask for weighted loss calculation

lr: 3.863459970955458e-05
wd: 0.0009967351093758648
lr_scheduler_freq: 1
lr_scheduler_interval: epoch
lr_scheduler_patience: 20
lr_scheduler_factor: 0.7
lr_monitor_key: val_loss
lr_scheduler_mode: onecycle  # Options: "onecycle", "plateau", or null/step (default: StepLR with step_size=1, gamma=0.5)
lr_scheduler_max_lr: 0.001   # Max learning rate for OneCycleLR (only used when mode=onecycle)
# lr_scheduler_total_steps: auto-calculated from dataloader size * max_epochs