_target_: perturbench.modelcore.models.GEARS
data_path: ${paths.work_dir}
gene2go_path: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/data/gene2go.pkl
gene_set_path: /fs-computility-new/upzd_share/maoxinjie/AIVC/mxj/perturbench-main/data/essential_all_data_pert_genes.pkl
# pert_key: ${data.pert_key}
pert_key: "_merged_pert_col_"
comb_delim: ${data.perturbation_combination_delimiter}
control_val: ${data.control_val}
build_GO_workers: 100
seed: 42
# GEARS原始论文参数 (从注释中恢复)
hidden_size: 64  # 原始: 64, 当前: 384 (过大导致过拟合)
num_go_gnn_layers: 1
num_gene_gnn_layers: 1  # 原始: 1, 当前: 2 (层数过多)
decoder_hidden_size: 16  # 原始: 16, 当前: 48 (过大)
num_similar_genes_go_graph: 20  # 原始: 20, 当前: 25
num_similar_genes_co_express_graph: 20  # 原始: 20, 当前: 15
coexpress_threshold: 0.4  # 原始: 0.4, 当前: 0.31 (过低)
uncertainty: False
uncertainty_reg: 1
direction_lambda: 1e-1

use_cell_emb: false
use_mask: true  # Enable expression mask for weighted loss calculation
# use_covs is now auto-configured based on data.transform.use_covs
# use_covs: False

lr: 1e-3  # GEARS原始学习率
wd: 1e-6  # 降低权重衰减
lr_scheduler_freq: 1
lr_scheduler_interval: epoch
lr_scheduler_patience: 10
lr_scheduler_factor: 0.5
lr_monitor_key: val_loss
lr_scheduler_mode: onecycle  # Options: "onecycle", "plateau", or null/step (default: StepLR with step_size=1, gamma=0.5)
# lr_scheduler_max_lr: 0.001   # Max learning rate for OneCycleLR (only used when mode=onecycle)
# lr_scheduler_total_steps: auto-calculated from dataloader size * max_epochs