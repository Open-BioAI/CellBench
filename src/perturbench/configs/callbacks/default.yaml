defaults:
  - early_stopping
  - lr_monitor
  - model_summary
  - rich_progress_bar
  - _self_

model_summary:
  max_depth: -1

# Checkpoint callbacks for loss and PCC
# These are defined here to ensure they are loaded by Hydra
# Using RobustModelCheckpoint to handle disk quota errors gracefully
model_checkpoint_loss:
  _target_: perturbench.modelcore.callbacks.robust_checkpoint.RobustModelCheckpoint
  monitor: val_loss_epoch
  mode: min
  dirpath: ${paths.output_dir}/checkpoints/loss
  filename: "epoch={epoch}-step={step}-valloss={val_loss_epoch:.4f}"
  save_top_k: 1
  save_last: false  # Disable to save disk space

model_checkpoint_pcc:
  _target_: perturbench.modelcore.callbacks.robust_checkpoint.RobustModelCheckpoint
  monitor: val_PCC_epoch
  mode: max
  dirpath: ${paths.output_dir}/checkpoints/pcc
  filename: "epoch={epoch}-step={step}-valpcc={val_PCC_epoch:.4f}"
  save_top_k: 1
  save_last: false  # Disable to save disk space, only save best checkpoint

# Optional: Save last checkpoint for easy resume
# Disabled by default to save disk space (only keep best loss and PCC checkpoints)
# Uncomment to enable:
# model_checkpoint_last:
#   _target_: perturbench.modelcore.callbacks.robust_checkpoint.RobustModelCheckpoint
#   dirpath: ${paths.output_dir}/checkpoints
#   filename: "last"
#   save_top_k: 0  # Don't save best, only last
#   save_last: true
